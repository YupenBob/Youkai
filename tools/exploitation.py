from __future__ import annotations

"""利用类工具封装（如 sqlmap、metasploit），需人工确认。"""

from langchain_core.tools import tool

from tools.base import ToolMetadata


HIGH_RISK_METADATA = ToolMetadata(
    name="exploitation",
    description="高危利用动作封装，需要人工审批后执行。",
    dangerous=True,
    human_approval_required=True,
)


@tool("placeholder_exploit", return_direct=False)
def placeholder_exploit(description: str) -> str:
    """占位 Tool：仅用于演示高危操作需要人工审批的设计。"""
    return (
        "[HUMAN_CHECK_REQUIRED] 收到潜在利用请求，但 exploitation 工具尚未实现。\n"
        "请在人工确认后，再补充具体的利用逻辑与调用参数：\n"
        f"- 描述: {description}"
    )


__all__ = ["HIGH_RISK_METADATA", "placeholder_exploit"]
