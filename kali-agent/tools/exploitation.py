from __future__ import annotations

"""利用类工具封装（如 sqlmap、metasploit）。

注意：本模块中的工具默认视为高危操作，必须经过人工确认后才能调用。
后续可以在这里封装：

- SQL 注入验证与利用（sqlmap）
- 漏洞利用框架调用（msfconsole / msfvenom）
- 弱口令爆破等
"""

from langchain_core.tools import tool

from tools.base import ToolMetadata


HIGH_RISK_METADATA = ToolMetadata(
    name="exploitation",
    description="高危利用动作封装，需要人工审批后执行。",
    dangerous=True,
    human_approval_required=True,
)


@tool("placeholder_exploit", return_direct=False)
def placeholder_exploit(description: str) -> str:
    """占位 Tool：仅用于演示高危操作需要人工审批的设计。

    当前不会真正执行任何攻击性命令。
    """

    return (
        "[HUMAN_CHECK_REQUIRED] 收到潜在利用请求，但 exploitation 工具尚未实现。\n"
        "请在人工确认后，再补充具体的利用逻辑与调用参数：\n"
        f"- 描述: {description}"
    )


__all__ = ["HIGH_RISK_METADATA", "placeholder_exploit"]

